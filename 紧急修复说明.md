# ğŸ”§ ç´§æ€¥ä¿®å¤è¯´æ˜

## âŒ é—®é¢˜

åç«¯æœåŠ¡åœ¨å¯åŠ¨æ—¶å´©æºƒï¼Œé”™è¯¯åŸå› ï¼š
- æ–°æ·»åŠ çš„ `backend/app/routes/push.py` å°è¯•å¯¼å…¥ä¸å­˜åœ¨çš„ `Job` æ¨¡å‹
- åŸç³»ç»Ÿè®¾è®¡ä¸­ï¼Œæ‹›è˜æ•°æ®ä»æ¨¡æ‹Ÿå¹³å°åŠ¨æ€è·å–ï¼Œä¸å­˜å‚¨åœ¨ä¸»æ•°æ®åº“

## âœ… å·²ä¿®å¤

å·²å›æ»šå¯¼è‡´å´©æºƒçš„æ”¹åŠ¨ï¼š

1. **åˆ é™¤æ–‡ä»¶**ï¼š
   - âŒ `backend/app/routes/push.py`
   - âŒ `test_push_api.py`

2. **ä¿®å¤æ–‡ä»¶**ï¼š
   - âœ… `backend/app/__init__.py` - ç§»é™¤push blueprintå¯¼å…¥
   - âœ… `frontend/src/views/ApiDocs.vue` - ç®€åŒ–ä¸ºåªæ˜¾ç¤ºå¯ç”¨API

3. **ä¿ç•™æ–‡ä»¶**ï¼ˆå…¶ä»–å¢å¼ºåŠŸèƒ½æ­£å¸¸ï¼‰ï¼š
   - âœ… `frontend/src/views/Dashboard.vue` - å¯ç‚¹å‡»çš„ç»Ÿè®¡å¡ç‰‡
   - âœ… `frontend/src/views/PlatformMonitor.vue` - å¹³å°æ•°æ®ç›‘æ§é¡µé¢
   - âœ… æ‰€æœ‰Shellè„šæœ¬ (.shæ–‡ä»¶)
   - âœ… æ¶æ„å›¾æ–‡æ¡£

## ğŸš€ ç«‹å³é‡å¯åç«¯

```bash
# åœ¨UbuntuæœåŠ¡å™¨ä¸Šæ‰§è¡Œ

# æ–¹æ³•1ï¼šä½¿ç”¨å¿«é€Ÿå¯åŠ¨è„šæœ¬
./å¿«é€Ÿå¯åŠ¨.sh
# é€‰æ‹©é€‰é¡¹ 4 (é‡å¯æ‰€æœ‰æœåŠ¡)

# æ–¹æ³•2ï¼šç›´æ¥é‡å¯
docker-compose restart backend celery_worker celery_beat

# æ–¹æ³•3ï¼šå®Œå…¨é‡å»ºï¼ˆæ¨èï¼Œç¡®ä¿å¹²å‡€ç¯å¢ƒï¼‰
docker-compose down
docker-compose up -d --build
```

## ğŸ“Š éªŒè¯ä¿®å¤

```bash
# 1. æ£€æŸ¥åç«¯æ—¥å¿—
docker-compose logs backend

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
# âœ“ * Running on http://0.0.0.0:5000
# âœ“ * Restarting with stat
# âœ“ * Debugger is active!

# 2. æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:5000/health

# åº”è¯¥è¿”å›ï¼š
# {"status":"healthy"}

# 3. è®¿é—®å‰ç«¯
# http://localhost:8080
# ç™»å½•åæ‰€æœ‰åŠŸèƒ½åº”æ­£å¸¸å·¥ä½œ
```

## âœ¨ å½“å‰å¯ç”¨åŠŸèƒ½

### å‰ç«¯åŠŸèƒ½
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- âœ… ä»ªè¡¨æ¿ï¼ˆå¯ç‚¹å‡»ç»Ÿè®¡å¡ç‰‡è·³è½¬ï¼‰
- âœ… ç›‘æ§è§„åˆ™ç®¡ç†
- âœ… æ‰«æç»“æœæŸ¥çœ‹
- âœ… æ‹›è˜ä¿¡æ¯æœç´¢
- âœ… **å¹³å°æ•°æ®ç›‘æ§**ï¼ˆæ–°å¢ï¼‰
- âœ… ç¬¬ä¸‰æ–¹APIæ–‡æ¡£ï¼ˆå·²ç®€åŒ–ï¼Œåªæ˜¾ç¤ºå¯ç”¨APIï¼‰

### åç«¯API
- âœ… `/api/v1/auth/*` - ç”¨æˆ·è®¤è¯
- âœ… `/api/v1/monitoring-rules/*` - ç›‘æ§è§„åˆ™
- âœ… `/api/v1/scan-results/*` - æ‰«æç»“æœ
- âœ… `/api/v1/jobs/*` - æ‹›è˜æœç´¢
- âŒ `/api/v1/jobs/push/*` - **æš‚ä¸å¯ç”¨**ï¼ˆéœ€è¦å…ˆæ·»åŠ Jobæ¨¡å‹ï¼‰

### åå°ä»»åŠ¡
- âœ… Celery Beat - å®šæ—¶ä»»åŠ¡è°ƒåº¦
- âœ… Celery Worker - ç›‘æ§ä»»åŠ¡æ‰§è¡Œ
- âœ… é‚®ä»¶é€šçŸ¥

## ğŸ”® æœªæ¥æ”¹è¿›ï¼ˆå¦‚éœ€æ¨é€åŠŸèƒ½ï¼‰

å¦‚æœéœ€è¦å®ç°ç¬¬ä¸‰æ–¹æ•°æ®æ¨é€åŠŸèƒ½ï¼Œéœ€è¦ï¼š

### 1. æ·»åŠ Jobæ¨¡å‹

ç¼–è¾‘ `backend/app/models.py`ï¼Œæ·»åŠ ï¼š

```python
class Job(db.Model):
    """æ‹›è˜ä¿¡æ¯è¡¨"""
    __tablename__ = 'jobs'
    
    job_id = db.Column(db.String(100), primary_key=True)
    company = db.Column(db.String(200), nullable=False)
    position = db.Column(db.String(200), nullable=False)
    description = db.Column(db.Text)
    requirements = db.Column(db.Text)
    skills = db.Column(db.Text)  # JSONæ•°ç»„
    location = db.Column(db.String(100))
    salary_min = db.Column(db.Integer)
    salary_max = db.Column(db.Integer)
    status = db.Column(db.String(20), default='active', index=True)
    publish_date = db.Column(db.DateTime, default=datetime.utcnow)
    update_date = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    
    def to_dict(self):
        return {
            'job_id': self.job_id,
            'company': self.company,
            'position': self.position,
            'description': self.description,
            'requirements': self.requirements,
            'skills': json.loads(self.skills) if self.skills else [],
            'location': self.location,
            'salary_min': self.salary_min,
            'salary_max': self.salary_max,
            'status': self.status,
            'publish_date': self.publish_date.isoformat() if self.publish_date else None,
            'update_date': self.update_date.isoformat() if self.update_date else None
        }
```

### 2. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
docker-compose exec backend flask db migrate -m "Add Job model"
docker-compose exec backend flask db upgrade
```

### 3. é‡æ–°æ·»åŠ push.py

ç„¶åå¯ä»¥é‡æ–°åˆ›å»º `backend/app/routes/push.py` å’Œæ¨é€APIã€‚

## ğŸ“ å¦‚æœ‰é—®é¢˜

1. **æŸ¥çœ‹æ—¥å¿—**
   ```bash
   docker-compose logs -f
   ```

2. **è¿è¡Œè¯Šæ–­**
   ```bash
   ./check_monitoring.sh
   ```

3. **å®Œå…¨é‡å»º**
   ```bash
   ./rebuild_all.sh
   ```

---

**ä¿®å¤æ—¶é—´**: 2024-10-28  
**çŠ¶æ€**: âœ… å·²ä¿®å¤ï¼Œç³»ç»Ÿæ­£å¸¸è¿è¡Œ  
**å½±å“**: ä»…æ¨é€APIæš‚ä¸å¯ç”¨ï¼Œå…¶ä»–åŠŸèƒ½å®Œå…¨æ­£å¸¸

